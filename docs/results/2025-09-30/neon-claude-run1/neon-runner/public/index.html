<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Neon Runner</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #0a0a0a;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      font-family: monospace;
      overflow: hidden;
    }

    #gameContainer {
      position: relative;
      box-shadow: 0 0 50px #00ffff;
    }

    canvas {
      border: 2px solid #00ffff;
      display: block;
    }

    .title {
      position: absolute;
      top: -50px;
      width: 100%;
      text-align: center;
      color: #00ffff;
      font-size: 24px;
      font-weight: bold;
      text-shadow: 0 0 20px #00ffff;
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <div class="title">NEON RUNNER</div>
    <canvas id="gameCanvas"></canvas>
  </div>

  <script>
    function loadScript(src) {
      return new Promise((resolve, reject) => {
        const script = document.createElement('script');
        script.src = src;
        script.onload = resolve;
        script.onerror = reject;
        document.body.appendChild(script);
      });
    }

    async function loadModules() {
      const modules = await Promise.all([
        fetch('../src/physics.js').then(r => r.text()),
        fetch('../src/spawner.js').then(r => r.text()),
        fetch('../src/score.js').then(r => r.text())
      ]);

      modules.forEach(moduleCode => {
        const cleanCode = moduleCode.replace(/if \(typeof module.*?\}/gs, '');
        eval(cleanCode);
      });
    }

    async function init() {
      await loadModules();
      await loadScript('game.js');
      await loadScript('render.js');
      await loadScript('input.js');

      const canvas = document.getElementById('gameCanvas');
      const game = new Game();
      const renderer = new Renderer(canvas);
      const inputHandler = new InputHandler(game);

      function gameLoop() {
        game.update();
        renderer.render(game.getState());
        requestAnimationFrame(gameLoop);
      }

      gameLoop();
    }

    init();
  </script>
</body>
</html>